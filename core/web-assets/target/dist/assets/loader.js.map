{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///./src/main/assets/modules/lib/loader/index.ts"],"names":["OnmsLoader","prefix","extension","mappings","modules","console","log","length","fragment","document","createDocumentFragment","module","loaded","debug","el","createElement","src","async","appendChild","error","body","name","check","onready","retry","nextRetry","Math","round","waitFor"],"mappings":"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","file":"loader.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn ","/* eslint no-console: 0 */\n\nexport default class OnmsLoader {\n  public prefix = '/opennms/assets/';\n  public extension = '.vaadin.js';\n  private loaded = new Set<string>();\n  private mappings: object;\n\n  public constructor(prefix?: string, extension?: string) {\n    if (prefix) {\n      this.prefix = prefix;\n    }\n    if (extension) {\n      this.extension = extension;\n    }\n\n    this.mappings = {\n      'backshift': this.prefix + 'backshift-js' + this.extension,\n      'bootstrap': this.prefix + 'bootstrap-js' + this.extension,\n      'd3': this.prefix + 'd3-js' + this.extension,\n      'flot': this.prefix + 'flot-js' + this.extension,\n      'global': this.prefix + 'global' + this.extension,\n      'holder': this.prefix + 'holder-js' + this.extension,\n      'ionicons-css': this.prefix + 'ionicons-css' + this.extension,\n      'jquery': this.prefix + 'jquery-js' + this.extension,\n      'jquery-ui': this.prefix + 'jquery-ui-js' + this.extension,\n      'leaflet': this.prefix + 'leaflet-js' + this.extension,\n      'manifest': this.prefix + 'manifest' + this.extension,\n      'onms-graph': this.prefix + 'onms-graph' + this.extension,\n//      'openlayers': this.prefix + 'legacy/openlayers-2.10/OpenLayers.js',\n      'vendor': this.prefix + 'vendor' + this.extension,\n    };\n  }\n\n  public load(...modules: string[]) {\n    console.log('OnmsLoader: loading ' + modules.length + ' modules.');\n\n    const fragment = document.createDocumentFragment();\n    for (const module of modules) {\n      if (this.loaded[module]) {\n        console.log('OnmsLoader: skipping ' + module + ' (already loaded)');\n      } else {\n        if (this.mappings[module]) {\n          console.debug('OnmsLoader: loading ' + module);\n          const el = document.createElement('script');\n          el.src = this.mappings[module];\n          el.async = false;\n          fragment.appendChild(el);\n          this.loaded[module] = true;\n        } else {\n          console.error('OnmsLoader: no mapping for module \"' + module + '\"!');\n        }\n      }\n    }\n    document.body.appendChild(fragment);\n    console.log('OnmsLoader: finished loading modules');\n  }\n\n  public waitFor(name: string, check: () => boolean, onready: () => void, retry = 50) {\n    if (check()) {\n      console.log('OnmsLoader: ' + name + ' is ready.');\n      onready();\n    } else if (retry < 10000) {\n      const nextRetry = Math.round(retry * 1.5);\n      console.log('OnmsLoader: ' + name + ' is not ready. Trying again in ' + nextRetry + 'ms.');\n      setTimeout(() => {\n        this.waitFor(name, check, onready, nextRetry);\n      }, nextRetry);\n    } else {\n      console.log('OnmsLoader: giving up on ' + name);\n    }\n  }\n}\n"],"sourceRoot":""}