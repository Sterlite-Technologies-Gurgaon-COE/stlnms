{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///./src/main/assets/js/apps/rws-storage/index.js"],"names":["RWS_ParseInFrameTextResponse","respText","objRWS","state","buff","idx","length","c","charAt","mc","exec","obj","pt","split","lt","i","mm","Array","RWS_InFrameResponseHandler","nameFrame","location","reload","windowFrame","frames","elementFrame","frameElement","elementFrameDoc","document","documentElement","detachEvent","RWS_handlerOnLoad","removeEventListener","textContent","innerText","objectResponse","RWS","show_default_alertbox","RWS_functionUserCallback","RWS_objectFormSubmit","parentNode","id","exception","alert","defmsg","rs","ResponseStatus","Class","Description","Code","ServiceMessage","replace","RWS_hrefLocationOnInit","disabled","RWS_ProcessInFrameResponse","objectForm","functionUserCallback","nameTargetFrame","RWS_windowTargetFrame","createElement","setAttribute","style","width","height","border","body","appendChild","target","elements","type","href","Function","name","attachEvent","addEventListener"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;;;;;;;;;;;;;;;;;;;;ACVA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,4BAAT,CAAsCC,QAAtC,EAAgDC,MAAhD,EAAwD;AACvD,MAAIC,KAAK,GAAG,CAAZ;AACA,MAAIC,IAAI,GAAG,EAAX;;AACA,OAAM,IAAIC,GAAG,GAAG,CAAhB,EAAmBA,GAAG,GAAGJ,QAAQ,CAACK,MAAlC,EAA0CD,GAAG,EAA7C,EAAiD;AAChD,QAAIE,CAAC,GAAGN,QAAQ,CAACO,MAAT,CAAgBH,GAAhB,CAAR;;AACA,QAAKE,CAAC,IAAI,IAAN,IAAgBA,CAAC,IAAI,IAAzB,EAAgC;AAC/BH,UAAI,IAAIG,CAAR;AACA;AACA;;AACD,QAAIH,IAAI,IAAI,EAAZ,EAAgB;AACf;AACA;;AACD,QAAID,KAAK,IAAI,CAAb,EAAgB;AACf,UAAIC,IAAI,IAAI,wBAAZ,EAAsC;AACrCD,aAAK,GAAG,CAAR;AACA;AACA;;AACD,UAAI,EAAEM,EAAE,GAAG,kEACRC,IADQ,CACHN,IADG,CAAP,CAAJ,EACgB;AACf;AACA;;AACD,UAAIO,GAAG,GAAGT,MAAV;AACA,UAAIU,EAAE,GAAGH,EAAE,CAAC,CAAD,CAAF,CAAMI,KAAN,CAAY,GAAZ,CAAT;AACA,UAAIC,EAAE,GAAGF,EAAE,CAACN,MAAH,GAAY,CAArB;;AACA,WAAKS,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGD,EAAhB,EAAoBC,CAAC,EAArB,EAAyB;AACxB,YAAIC,EAAE,GAAG,qBAAqBN,IAArB,CAA0BE,EAAE,CAACG,CAAD,CAA5B,CAAT;;AACA,YAAI,CAACJ,GAAG,CAACK,EAAE,CAAC,CAAD,CAAH,CAAR,EAAiB;AAChBL,aAAG,CAACK,EAAE,CAAC,CAAD,CAAH,CAAH,GAAa,IAAIC,KAAJ,EAAb;AACAN,aAAG,CAACK,EAAE,CAAC,CAAD,CAAH,CAAH,CAAWA,EAAE,CAAC,CAAD,CAAb,IAAoB,EAApB;AACA;;AACDL,WAAG,GAAGA,GAAG,CAACK,EAAE,CAAC,CAAD,CAAH,CAAH,CAAWA,EAAE,CAAC,CAAD,CAAb,CAAN;AACA;;AACD,UAAI,CAACL,GAAG,CAACF,EAAE,CAAC,CAAD,CAAH,CAAR,EAAiB;AAChBE,WAAG,CAACF,EAAE,CAAC,CAAD,CAAH,CAAH,GAAa,IAAIQ,KAAJ,EAAb;AACA;;AACDN,SAAG,CAACF,EAAE,CAAC,CAAD,CAAH,CAAH,CAAWA,EAAE,CAAC,CAAD,CAAb,IAAoBA,EAAE,CAAC,CAAD,CAAtB;AACA,KAxBD,MAwBO,IAAIL,IAAI,IAAI,0BAAZ,EAAwC;AAC9CD,WAAK,GAAG,CAAR;AACA;;AACD;AACAC,QAAI,GAAG,EAAP;AACA;;AACD,SAAQD,KAAK,IAAI,CAAjB;AACA,C,CACD;AAEA;AACA;AACA;;;AAEA,SAASe,0BAAT,CAAoCC,SAApC,EAA+C;AAE9C;AAEAC,UAAQ,CAACC,MAAT,CAAgB,IAAhB;AACA,SAAO,IAAP,CAL8C,CAO9C;;AACA,MAAIC,WAAW,GAAGC,MAAM,CAACJ,SAAD,CAAxB;AACA,MAAIK,YAAY,GAAGF,WAAW,CAACG,YAA/B;AACA,MAAIC,eAAe,GAAGJ,WAAW,CAACK,QAAZ,CAAqBC,eAA3C,CAV8C,CAY9C;;AAEA,MAAIJ,YAAY,CAACK,WAAjB,EAA8B;AAC7BL,gBAAY,CAACK,WAAb,CAAyB,QAAzB,EAAmCL,YAAY,CAACM,iBAAhD;AACA,GAFD,MAEO;AACNN,gBAAY,CAACO,mBAAb,CAAiC,MAAjC,EACEP,YAAY,CAACM,iBADf,EACkC,KADlC;AAEA;;AAEDN,cAAY,CAACM,iBAAb,GAAiC,IAAjC,CArB8C,CAuB9C;;AAEA,MAAIJ,eAAe,CAACM,WAApB,EAAiC;AAChC,QAAI/B,QAAQ,GAAGyB,eAAe,CAACM,WAA/B;AACA,GAFD,MAEO,IAAIN,eAAe,CAACO,SAApB,EAA+B;AACrC,QAAIhC,QAAQ,GAAGyB,eAAe,CAACO,SAA/B;AACA,GAFM,MAEA;AACN,QAAIhC,QAAQ,GAAG,EAAf;AACA,GA/B6C,CAiC9C;;;AAEA,MAAIiC,cAAc,GAAG,EAArB;AACAA,gBAAc,CAACC,GAAf,GAAqB,EAArB;;AAEA,MAAIlC,QAAQ,IAAI,EAAhB,EAAoB;AACnB,QAAI,CAACD,4BAA4B,CAACC,QAAD,EAAWiC,cAAc,CAACC,GAA1B,CAAjC,EAAiE;AAChE,aAAOD,cAAc,CAACC,GAAtB;AACAD,oBAAc,CAACC,GAAf,GAAqB,IAArB;AACA;AACD,GA3C6C,CA6C9C;;;AAEA,MAAIC,qBAAqB,GAAG,IAA5B;;AAEA,MAAIZ,YAAY,CAACa,wBAAjB,EAA2C;AAC1C,QAAI;AACHD,2BAAqB,GAAGZ,YAAY,CAACa,wBAAb,CACtBb,YAAY,CAACc,oBAAb,CAAkCC,UAAlC,CAA6CC,EADvB,EAEtBN,cAFsB,CAAxB;AAGA,KAJD,CAIE,OAAOO,SAAP,EAAkB;AACnBC,WAAK,CAAC,4FACFD,SADE,GAEF,gDAFC,CAAL;AAGA;AACD;;AAEDjB,cAAY,CAACa,wBAAb,GAAwC,IAAxC;;AAEA,MAAID,qBAAJ,EAA2B;AAC1B,QAAIO,MAAM,GAAG,kDAAb;;AAEA,QAAIT,cAAc,CAACC,GAAnB,EAAwB;AACvB,UAAIS,EAAE,GAAGV,cAAc,CAACC,GAAf,CAAmBU,cAAnB,CAAkC,CAAlC,CAAT;AACAH,WAAK,CAACC,MAAM,GAAGC,EAAE,CAACE,KAAH,CAAS,CAAT,CAAT,GAAuB,IAAvB,GAA8BF,EAAE,CAACG,WAAH,CAAe,CAAf,CAA9B,GAAkD,IAAlD,GACFH,EAAE,CAACI,IAAH,CAAQ,CAAR,CADE,GACW,OADX,GACqBJ,EAAE,CAACK,cAAH,CAAkB,CAAlB,CADrB,GAC4C,IAD7C,CAAL;AAEA,KAJD,MAIO;AACNP,WAAK,CAACC,MAAM,GACR,oEADC,CAAL;AAEA;AACD,GA1E6C,CA4E9C;;;AACArB,aAAW,CAACK,QAAZ,CAAqBP,QAArB,CAA8B8B,OAA9B,CAAsC1B,YAAY,CAAC2B,sBAAnD,EA7E8C,CA+E9C;;AACA,MAAI3B,YAAY,CAACc,oBAAjB,EAAuC;AACtCd,gBAAY,CAACc,oBAAb,CAAkCc,QAAlC,GAA6C,KAA7C;AACA;AAED,C,CACD;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,SAASC,0BAAT,CAAoCC,UAApC,EAAgDC,oBAAhD,EACEC,eADF,EACmB;AAElB;AAEA,MAAI,EAAElC,WAAW,GAAGgC,UAAU,CAACG,qBAA3B,CAAJ,EAAuD;AACtD,QAAI,CAACD,eAAL,EAAsB;AACrB,UAAIA,eAAe,GAAGF,UAAU,CAACd,EAAX,GAAgB,0BAAtC;AACA;;AAED,QAAI,EAAElB,WAAW,GAAGC,MAAM,CAACiC,eAAD,CAAtB,CAAJ,EAA8C;AAC7C;AACA,UAAI7B,QAAQ,CAAC+B,aAAb,EAA4B;AAC3B;AACA,YAAI;AACHlC,sBAAY,GAAGG,QAAQ,CACpB+B,aADY,CACE,mBACXF,eADW,GAEX,QAFW,GAGXA,eAHW,GAIX,2DALS,CAAf;AAMA,SAPD,CAOE,OAAOf,SAAP,EAAkB;AACnBjB,sBAAY,GAAGG,QAAQ,CAAC+B,aAAT,CAAuB,QAAvB,CAAf;AACAlC,sBAAY,CAACmC,YAAb,CAA0B,MAA1B,EAAkCH,eAAlC;AACAhC,sBAAY,CAACmC,YAAb,CAA0B,IAA1B,EAAgCH,eAAhC;AACAhC,sBAAY,CAACmC,YAAb,CAA0B,KAA1B,EAAiC,EAAjC;AACAnC,sBAAY,CAACoC,KAAb,CAAmBC,KAAnB,GAA2B,KAA3B;AACArC,sBAAY,CAACoC,KAAb,CAAmBE,MAAnB,GAA4B,KAA5B;AACAtC,sBAAY,CAACoC,KAAb,CAAmBG,MAAnB,GAA4B,KAA5B;AACA;;AACDpC,gBAAQ,CAACqC,IAAT,CAAcC,WAAd,CAA0BzC,YAA1B;AACA;;AACD,UAAI,EAAEF,WAAW,GAAGC,MAAM,CAACiC,eAAD,CAAtB,CAAJ,EAA8C;AAC7Cd,aAAK,CAAC,iDAAD,CAAL;AACA,eAAO,KAAP;AACA;AACD,KA/BqD,CAiCtD;;;AACAY,cAAU,CAACG,qBAAX,GAAmCnC,WAAnC,CAlCsD,CAoCtD;;AACAgC,cAAU,CAACY,MAAX,GAAoBV,eAApB;AACA,GA1CiB,CA4ClB;;;AAEAhC,cAAY,GAAGF,WAAW,CAACG,YAA3B,CA9CkB,CAgDlB;;AAEA,MAAID,YAAY,CAACc,oBAAjB,EAAuC;AACtCd,gBAAY,CAACc,oBAAb,CAAkCc,QAAlC,GAA6C,IAA7C;AACA,GAFD,MAEO;AACN5B,gBAAY,CAACc,oBAAb,GAAoC,IAApC;;AACA,SAAKvB,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGuC,UAAU,CAACa,QAAX,CAAoB7D,MAApC,EAA4CS,CAAC,EAA7C,EAAiD;AAChD,UAAIuC,UAAU,CAACa,QAAX,CAAoBpD,CAApB,EAAuBqD,IAAvB,IAA+B,QAAnC,EAA6C;AAC5C5C,oBAAY,CAACc,oBAAb,GAAoCgB,UAAU,CAACa,QAAX,CAAoBpD,CAApB,CAApC;AACAS,oBAAY,CAACc,oBAAb,CAAkCc,QAAlC,GAA6C,IAA7C;AACA;AACA;AACD;AACD,GA7DiB,CA+DlB;AACA;;;AAEA,MAAI,CAAC5B,YAAY,CAAC2B,sBAAlB,EAA0C;AACzC3B,gBAAY,CAAC2B,sBAAb,GAAsC7B,WAAW,CAACK,QAAZ,CAAqBP,QAArB,CAA8BiD,IAApE;AACA,GApEiB,CAsElB;;;AAEA,MAAId,oBAAJ,EAA0B;AACzB,QAAI;AACHA,0BAAoB,CAACD,UAAU,CAACd,EAAZ,EAAgB,IAAhB,CAApB;AACAhB,kBAAY,CAACa,wBAAb,GAAwCkB,oBAAxC;AACA,KAHD,CAGE,OAAOd,SAAP,EAAkB;AACnBC,WAAK,CAAC,4FACFD,SADE,GAEF,gDAFC,CAAL;AAGAjB,kBAAY,CAACa,wBAAb,GAAwC,IAAxC;AACA;AACD,GAlFiB,CAoFlB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEAb,cAAY,CAACM,iBAAb,GAAiC,IAAIwC,QAAJ,CAC/B,iCAAiC9C,YAAY,CAAC+C,IAA9C,GAAqD,IADtB,CAAjC,CAvGkB,CA0GlB;AACA;;AAEA,MAAI;AACH,QAAI/C,YAAY,CAACgD,WAAjB,EAA8B;AAC7BhD,kBAAY,CAACgD,WAAb,CAAyB,QAAzB,EAAmChD,YAAY,CAACM,iBAAhD;AACA,KAFD,MAEO;AACNN,kBAAY,CAACiD,gBAAb,CAA8B,MAA9B,EACEjD,YAAY,CAACM,iBADf,EACkC,KADlC;AAEA;AACD,GAPD,CAOE,OAAOW,SAAP,EAAkB;AACnBC,SAAK,CAAC,6CAA6CD,SAA7C,GACF,qBADC,CAAL;;AAEA,QAAIjB,YAAY,CAACc,oBAAjB,EAAuC;AACtCd,kBAAY,CAACc,oBAAb,CAAkCc,QAAlC,GAA6C,KAA7C;AACA;;AACD,WAAO,KAAP;AACA,GA3HiB,CA6HlB;;;AAEA,SAAO,IAAP;AAEA,C,CACD,iF","file":"rws-storage.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn ","/*******************************************************************************\n * File-upload JavaScript Module for RWS STORAGE SERVICE - version 0.6\n * \n * Copyright (c) 2009+ Rocco Rionero Copyright (c) 2009+ The OpenNMS Group, Inc.\n * All rights reserved everywhere.\n * \n * This program was developed and is maintained by Rocco RIONERO (\"the author\")\n * and is subject to dual-copyright according to the terms set in \"The OpenNMS\n * Project Contributor Agreement\".\n * \n * This program is free software; you can redistribute it and/or modify it under\n * the terms of the GNU General Public License as published by the Free Software\n * Foundation; either version 2 of the License, or (at your option) any later\n * version.\n * \n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\n * FOR A PARTICULAR PURPOSE. See the GNU General Public License for more\n * details.\n * \n * You should have received a copy of the GNU General Public License along with\n * this program; if not, write to the Free Software Foundation, Inc., 59 Temple\n * Place - Suite 330, Boston, MA 02111-1307, USA.\n * \n * The author can be contacted at the following email address:\n * \n * Rocco RIONERO rock (at) rionero.com\n * \n * (please, specify \"rws-storage-service\" in the subject of your msg.)\n * \n * ------------------------------------------------------------------------\n * OpenNMS Network Management System is Copyright by The OpenNMS Group, Inc\n * ------------------------------------------------------------------------\n * \n * UNSUPPORTED BETA-RELEASE SOFTWARE VERSION\n * \n ******************************************************************************/\n\n/* eslint-disable */\n\n// -------------------------------------------------------------------------------\n// This function parses the RWS response (in text format) and builds the\n// corresponding JavaScript objects hierarchy tree starting from the passed\n// objRWS (which will correspond to the root \"RWS\" node).\n// Returns true if the entire response was parsed successufully, false\n// otherwise;\nfunction RWS_ParseInFrameTextResponse(respText, objRWS) {\n\tvar state = 0;\n\tvar buff = \"\";\n\tfor ( var idx = 0; idx < respText.length; idx++) {\n\t\tvar c = respText.charAt(idx);\n\t\tif ((c != '\\r') && (c != '\\n')) {\n\t\t\tbuff += c;\n\t\t\tcontinue;\n\t\t}\n\t\tif (buff == \"\") {\n\t\t\tcontinue;\n\t\t}\n\t\tif (state == 1) {\n\t\t\tif (buff == \"---RWS-RESPONSE-END---\") {\n\t\t\t\tstate = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (!(mc = /^RWS\\.((?:[^\\[\\.=]+\\[[0-9]+\\]\\.)*)([^\\[\\.=]+)\\[([0-9]+)\\]=(.*)$/\n\t\t\t\t\t.exec(buff))) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar obj = objRWS;\n\t\t\tvar pt = mc[1].split(\".\");\n\t\t\tvar lt = pt.length - 1;\n\t\t\tfor (i = 0; i < lt; i++) {\n\t\t\t\tvar mm = /^([^\\[]*)\\[(.*)\\]$/.exec(pt[i]);\n\t\t\t\tif (!obj[mm[1]]) {\n\t\t\t\t\tobj[mm[1]] = new Array();\n\t\t\t\t\tobj[mm[1]][mm[2]] = {};\n\t\t\t\t}\n\t\t\t\tobj = obj[mm[1]][mm[2]];\n\t\t\t}\n\t\t\tif (!obj[mc[2]]) {\n\t\t\t\tobj[mc[2]] = new Array();\n\t\t\t}\n\t\t\tobj[mc[2]][mc[3]] = mc[4];\n\t\t} else if (buff == \"---RWS-RESPONSE-BEGIN---\") {\n\t\t\tstate = 1\n\t\t}\n\t\t;\n\t\tbuff = \"\";\n\t}\n\treturn (state == 2);\n}\n//-------------------------------------------------------------------------------\n\n// -------------------------------------------------------------------------------\n// This is the event handler executed as soon as a response is received into the\n// target (hidden) IFRAME.\n\nfunction RWS_InFrameResponseHandler(nameFrame) {\n\n\t// workaround.....\n\n\tlocation.reload(true);\n\treturn true;\n\n\t// this code is to be enable\n\tvar windowFrame = frames[nameFrame];\n\tvar elementFrame = windowFrame.frameElement;\n\tvar elementFrameDoc = windowFrame.document.documentElement;\n\n\t// detach the response-handler from the target frame\n\n\tif (elementFrame.detachEvent) {\n\t\telementFrame.detachEvent(\"onload\", elementFrame.RWS_handlerOnLoad);\n\t} else {\n\t\telementFrame.removeEventListener(\"load\",\n\t\t\t\telementFrame.RWS_handlerOnLoad, false);\n\t}\n\n\telementFrame.RWS_handlerOnLoad = null;\n\n\t// get the text response from the target frame\n\n\tif (elementFrameDoc.textContent) {\n\t\tvar respText = elementFrameDoc.textContent;\n\t} else if (elementFrameDoc.innerText) {\n\t\tvar respText = elementFrameDoc.innerText;\n\t} else {\n\t\tvar respText = \"\";\n\t}\n\n\t// parse the text response and build the JS response object\n\n\tvar objectResponse = {};\n\tobjectResponse.RWS = {};\n\n\tif (respText != \"\") {\n\t\tif (!RWS_ParseInFrameTextResponse(respText, objectResponse.RWS)) {\n\t\t\tdelete objectResponse.RWS;\n\t\t\tobjectResponse.RWS = null;\n\t\t}\n\t}\n\n\t// call the user function (if callback not defined, show a default alert box)\n\n\tvar show_default_alertbox = true;\n\n\tif (elementFrame.RWS_functionUserCallback) {\n\t\ttry {\n\t\t\tshow_default_alertbox = elementFrame.RWS_functionUserCallback(\n\t\t\t\t\telementFrame.RWS_objectFormSubmit.parentNode.id,\n\t\t\t\t\tobjectResponse);\n\t\t} catch (exception) {\n\t\t\talert(\"The following exception occurred while executing the user-defined response handler:\\n\\n\"\n\t\t\t\t\t+ exception\n\t\t\t\t\t+ \"\\n\\nThe default response handler will be used.\");\n\t\t}\n\t}\n\n\telementFrame.RWS_functionUserCallback = null;\n\n\tif (show_default_alertbox) {\n\t\tvar defmsg = \"[RWS FORM Client - Default Response Handler]\\n\\n\";\n\n\t\tif (objectResponse.RWS) {\n\t\t\tvar rs = objectResponse.RWS.ResponseStatus[0];\n\t\t\talert(defmsg + rs.Class[0] + \": \" + rs.Description[0] + \" [\"\n\t\t\t\t\t+ rs.Code[0] + \"]\\n\\n\" + rs.ServiceMessage[0] + \"\\n\");\n\t\t} else {\n\t\t\talert(defmsg\n\t\t\t\t\t+ \"Warning: the RWS server returned an invalid or malformed response.\");\n\t\t}\n\t}\n\n\t// this solves partially the \"history-back\" problem (at least on IE)\n\twindowFrame.document.location.replace(elementFrame.RWS_hrefLocationOnInit);\n\n\t// re-enable the submit button\n\tif (elementFrame.RWS_objectFormSubmit) {\n\t\telementFrame.RWS_objectFormSubmit.disabled = false;\n\t}\n\n}\n//-------------------------------------------------------------------------------\n\n// -------------------------------------------------------------------------------\n// RWS_ProcessInFrameResponse\n//\n// Called as \"onsubmit\" handler for the upload form.\n//\n// Arguments:\n//\n// objectForm the form object\n// functionUserCallback the user-defined callback function\n// nameTargetFrame the name of the target frame (see below)\n//\n// Note:\n// The first time this function gets called (i.e. the first time\n// a \"submit\" is done from a given form) it associates a \"target\n// frame\" to the form (it will be used to receive the server's\n// response to the POST request); here is what it does:\n//\n// 1) if the <nameTargetFrame> argument is NOT specified, an hidden\n// iframe will be created and assigned a name (and ID) derived\n// from the name of the posting form;\n// 2) if the <nameTargetFrame> argument IS specified but NO frame\n// with such name exists, an hidden iframe will be created (as\n// in previous point) and will be assigned the name (and ID)\n// specified by the <nameTargetFrame> argument;\n// 3) if the <nameTargetFrame> argument IS specified AND a frame\n// with such name DOES exist, such frame will be used as target;\n//\n// This gives you a way to solve cross-browser incompatibilities in\n// iframe creation from JavaScript: the implemented code should\n// work with most current browsers but if you found problems or\n// just want to be on the safe side, create your hidden iframe with\n// the usual HTML tag, give it a unique name and ID and pass it as\n// <nameTargetFrame> to this function.\n\nfunction RWS_ProcessInFrameResponse(objectForm, functionUserCallback,\n\t\tnameTargetFrame) {\n\n\t// identify or create the target frame\n\n\tif (!(windowFrame = objectForm.RWS_windowTargetFrame)) {\n\t\tif (!nameTargetFrame) {\n\t\t\tvar nameTargetFrame = objectForm.id + \"_RWS_ResponseTargetFrame\";\n\t\t}\n\n\t\tif (!(windowFrame = frames[nameTargetFrame])) {\n\t\t\t// must create the frame\n\t\t\tif (document.createElement) {\n\t\t\t\t// go ahead\n\t\t\t\ttry {\n\t\t\t\t\telementFrame = document\n\t\t\t\t\t\t\t.createElement('<iframe name=\"'\n\t\t\t\t\t\t\t\t\t+ nameTargetFrame\n\t\t\t\t\t\t\t\t\t+ '\" id=\"'\n\t\t\t\t\t\t\t\t\t+ nameTargetFrame\n\t\t\t\t\t\t\t\t\t+ '\" src=\"\" style=\"width:0;height:0;border:0px solid #fff;\">');\n\t\t\t\t} catch (exception) {\n\t\t\t\t\telementFrame = document.createElement('iframe');\n\t\t\t\t\telementFrame.setAttribute(\"name\", nameTargetFrame);\n\t\t\t\t\telementFrame.setAttribute(\"id\", nameTargetFrame);\n\t\t\t\t\telementFrame.setAttribute(\"src\", \"\");\n\t\t\t\t\telementFrame.style.width = \"0px\";\n\t\t\t\t\telementFrame.style.height = \"0px\";\n\t\t\t\t\telementFrame.style.border = \"0px\";\n\t\t\t\t}\n\t\t\t\tdocument.body.appendChild(elementFrame);\n\t\t\t}\n\t\t\tif (!(windowFrame = frames[nameTargetFrame])) {\n\t\t\t\talert(\"Unable to create target IFRAME, upload aborted.\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\t// store into the form object a reference to the frame's window object\n\t\tobjectForm.RWS_windowTargetFrame = windowFrame;\n\n\t\t// the frame will be the target for the submit's response\n\t\tobjectForm.target = nameTargetFrame;\n\t}\n\n\t// obtain the frame element from the frame's window object\n\n\telementFrame = windowFrame.frameElement;\n\n\t// identify the submit button and disable the control\n\n\tif (elementFrame.RWS_objectFormSubmit) {\n\t\telementFrame.RWS_objectFormSubmit.disabled = true;\n\t} else {\n\t\telementFrame.RWS_objectFormSubmit = null;\n\t\tfor (i = 0; i < objectForm.elements.length; i++) {\n\t\t\tif (objectForm.elements[i].type == \"submit\") {\n\t\t\t\telementFrame.RWS_objectFormSubmit = objectForm.elements[i];\n\t\t\t\telementFrame.RWS_objectFormSubmit.disabled = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// this is to partially solve the \"history-back\" problem (see the\n\t// response handler for the other half-part of the story)\n\n\tif (!elementFrame.RWS_hrefLocationOnInit) {\n\t\telementFrame.RWS_hrefLocationOnInit = windowFrame.document.location.href;\n\t}\n\n\t// call the user function to notify that we're starting...\n\n\tif (functionUserCallback) {\n\t\ttry {\n\t\t\tfunctionUserCallback(objectForm.id, null);\n\t\t\telementFrame.RWS_functionUserCallback = functionUserCallback;\n\t\t} catch (exception) {\n\t\t\talert(\"The following exception occurred while executing the user-defined response handler:\\n\\n\"\n\t\t\t\t\t+ exception\n\t\t\t\t\t+ \"\\n\\nThe default response handler will be used.\");\n\t\t\telementFrame.RWS_functionUserCallback = null;\n\t\t}\n\t}\n\n\t// oh, yeah, this is a dirty (or, maybe, smart?) trick... but no way\n\t// out as we need to pass the handler a reference to target frame\n\t// (and with IE this is not possible, unless we want to use the\n\t// global namespace): moreover we cannot use a \"floating\" anonymous\n\t// function here or we won't be able to detach the handler when we're\n\t// done (btw, an anonymous function which passes some local parameter\n\t// and gets called by an event handler is anyway a bad idea as it\n\t// might easily result in memory leaks). Here is the \"trick\" explained:\n\t// a function-object is created with the \"Function()\" contructor and\n\t// the function body, just a call to RWS_InFrameResponseHandler(), is\n\t// specified in such a way that the \"elementFrame.name\" argument is\n\t// evaluated when the function is \"compiled\". So the actual call to\n\t// RWS_InFrameResponseHandler() will have as passed argument a static\n\t// string (the name of the frame): no local context will be saved\n\t// because everything is static. The resulting function-object will be\n\t// assigned to a custom property of the elementFrame object, and such\n\t// property will be passed to both the attach/add and detach/remove\n\t// methods... and everything works fine.\n\n\telementFrame.RWS_handlerOnLoad = new Function(\n\t\t\t\"RWS_InFrameResponseHandler('\" + elementFrame.name + \"')\");\n\n\t// attach the response-handler to the target frame, so to be executed as\n\t// soon as a response is received by the RWS service\n\n\ttry {\n\t\tif (elementFrame.attachEvent) {\n\t\t\telementFrame.attachEvent(\"onload\", elementFrame.RWS_handlerOnLoad);\n\t\t} else {\n\t\t\telementFrame.addEventListener(\"load\",\n\t\t\t\t\telementFrame.RWS_handlerOnLoad, false);\n\t\t}\n\t} catch (exception) {\n\t\talert(\"Unable to attach the upload handler:\\n\\n\" + exception\n\t\t\t\t+ \"\\n\\nUpload aborted.\");\n\t\tif (elementFrame.RWS_objectFormSubmit) {\n\t\t\telementFrame.RWS_objectFormSubmit.disabled = false;\n\t\t}\n\t\treturn false;\n\t}\n\n\t// everything ok, so far: return true and let the show go on\n\n\treturn true;\n\n}\n//-------------------------------------------------------------------------------\n"],"sourceRoot":""}